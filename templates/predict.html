{% extends "layout.html" %}

{% block head %}
  <!-- Bootstrap only for alerts/buttons if you want -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
{% endblock head %}

{% block content %}
<div class="container">
  <h1>Packet Details</h1>
  <p class="text-center" style="color:#94a3b8;">Please fill in the following features:</p>

  <!-- Flash messages -->
  {% with messages = get_flashed_messages(with_categories=true) %}
    {% if messages %}
      {% for category, message in messages %}
        <div class="alert alert-{{ 'success' if category == 'success' else 'danger' }} alert-dismissible fade show">
          {{ message }}
          <button type="button" class="btn-close btn-close-white" data-bs-dismiss="alert"></button>
        </div>
      {% endfor %}
    {% endif %}
  {% endwith %}

  <form action="/predict" method="POST">

    {% for feature in [
      "Fwd Packet Length Max", "Fwd Packet Length Mean", "Bwd Packets/s",
      "Total Length of Fwd Packets", "Subflow Fwd Bytes", "Flow Packets/s",
      "Packet Length Std", "Flow IAT Mean", "Avg Fwd Segment Size", "Flow IAT Max",
      "Init_Win_bytes_backward", "Avg Bwd Segment Size", "Bwd Packet Length Mean",
      "Flow Duration", "Bwd Packet Length Std", "Bwd Packet Length Max",
      "Subflow Bwd Bytes", "Total Length of Bwd Packets", "Destination Port",
      "Packet Length Variance"
    ] %}

      <div>
        <label>{{ feature }}</label>

        {% if feature == "Destination Port" %}
          <input type="number" step="1" min="0" max="65535"
                 name="{{ feature }}" placeholder="0 - 65535" required>
        {% else %}
          <input type="number" step="any"
                 name="{{ feature }}" placeholder="Enter value" required>
        {% endif %}
      </div>

    {% endfor %}

    <!-- âœ… Predict button LAST and full width -->
    <div class="full-width">
      <button type="submit" class="button">Predict</button>
    </div>

  </form>

  {% if result %}
    <div class="result">
      <h2 style="color:#38bdf8;">Result</h2>
      <div class="result-box">{{ result }}</div>
    </div>
  {% endif %}
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
{% endblock content %}
